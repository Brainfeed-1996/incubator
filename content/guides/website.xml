<?xml version="1.0" encoding="UTF-8"?>
<!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<document>
  <properties>
    <atom url="http://mail-archives.apache.org/mod_mbox/incubator-general/?format=atom">general@incubator.apache.org Archives</atom>
    <title>Updating the top-level Incubator website</title>
  </properties>
  <body>
    <section id="Overview+of+the+Incubator+site">
      <title>Overview of the Incubator site</title>

      <p>The Incubator website is generated by the Apache CMS, but it
         is still using the Anakia-based page generation mechanism that was
         used before, 
         triggered by a <a href="http://svn.apache.org/repos/asf/incubator/public/trunk/build_cms.sh">CMS external build script</a>.
      </p>
      <p>
         This means that you can edit the content either directly in svn
         (and use ant to generate and check the results), or edit via the
         CMS interface, but final publishing has to be done via the CMS
         (see below for how).
      </p>

      <p>The source to the Incubator website lives at:</p>
      <note><a href="http://svn.apache.org/repos/asf/incubator/public/trunk">
          http://svn.apache.org/repos/asf/incubator/public/trunk</a></note>

      <p>The production documents are kept in the "infra" SVN repository
        at https://svn.apache.org/repos/infra/websites/production/incubator.
        That directory is then managed by svnpubsub on the server
         to re-create the live website.</p>

    </section>
    <section id="Edit+the+content">
      <title>Edit the content</title>
      <section id="Help+Wanted">
        <title>Help Wanted!</title>
        <p>
         People with commit access to the "incubator" SVN can edit the source
         documents in the "content" directory. That is any ASF Member and
         any committer on a current podling in incubation. So you can all help to
         keep your project's Status page up-to-date, and if you find problems with
         the "guidelines" docs then can immediately fix them.
         If unsure, then discuss changes on the general mailing list.
         Note that the "policy" documents need special treatment.
        </p>
        <p>
         Anyone else can send patches to those documents to the INCUBATOR issue tracker.
        </p>
      </section>

      <section id="Checkout+the+Incubator+SVN">
        <title>Checkout the Incubator SVN site</title>
        <code>
svn co http://svn.apache.org/repos/asf/incubator/public/trunk incubator<br />
cd incubator
</code>
        <note>If you are a committer and intending to commit your changes,
              please ensure you use https instead of http.</note>
      </section>
      <section id="Edit+the+source+documents">
        <title>Edit the source documents</title>
        <p>The source content is in Anakia xdoc format at the "content" directory.</p>
      </section>
      <section id="Add+a+new+document">
        <title>Add a new document</title>
        <p>Add new documents in the content directories, then do 'svn add'.</p>
      </section>
      <section id="Edit+your+project+status+page">
        <title>Edit your project status page</title>
        <p>The sources for the status pages are in
           <code>content/projects/*.xml</code></p>
        <section id='create-status-page'><title>Create Status Page</title>
        <ol>
           <li>
           Copy from the template
           <code>content/projects/incubation-status-template.xml</code> to
           <code>content/projects/${project}.xml</code> then <code>'svn add'</code>
           </li>
           <li>
           The copied template contains customization instructions. Follow them.
           </li>
           <li>
           Go through the template actions. Delete any which are not 
           relevant and mark as completed any actions which are already 
           done.
           </li>
           <li>
           Add an entry with status "current" to the podlings summary file at
           <code>content/podlings.xml</code> and ensure that the
           list of mentors is up-to-date.
           </li>
           <li>
           Do <code>'svn update'</code> to be sure you are up-to-date.
           </li>
           <li>
           Regenerate the documentation by running <code>'ant'</code> or <code>'build'</code> from the top-level.
           See more detail about this process in the following section. Note that
           there will be many output changes because a new entry has been added to
           the right-hand menu which is replicated on every page.  The results wil
           be built to the <pre>target/site</pre> directory by default- please look them over,
           but do not add this directory nor its contents to svn!
            </li>
           <li>
           <code>svn commit</code> all of the source changes with a good message.
           </li>
           <li>
           Review your changes via the
           "<a href="lists.html#cvs+at+incubator.apache.org">commits</a>"
           mail list.
           </li>
           <li>
           Wait a minute or two for the CMS to build your changes, then publish them
           by visiting the <a href="https://cms.apache.org/incubator/publish">Publish site</a>
           page.  
           See other <a href="http://www.apache.org/dev/project-site.html">notes</a>
           about this step.
           </li>
   </ol>
   <note>This status page is to be kept up to date regularly. This is NOT the same as the 'status report' which is a
           board report entry in the incubator wiki. You still need to follow your monthly/quarterly status reports
   </note>
        </section>
      </section>
    </section>
    <section id="Generating+the+top-level+website">
      <title>Generating the top-level website</title>
      <note>Please generate the website yourself and check in the changes.
             If you have any problems, ask for help on the Incubator's
             <a href="lists.html#general+at+incubator.apache.org">general</a> list.</note>
        <p>In the top-level "incubator" SVN directory, do 'ant'
           to render the HTML files into the <pre>target/site</pre> directory.
           (If you don't have ant installed, you can run build.sh or build.bat
           instead.)  If the site built without errors, then do the usual
           SVN stuff: 'svn status' 'svn add' 'svn diff' 'svn commit'.</p>
        <p>
           Review your changes via the
           "<a href="lists.html#cvs+at+incubator.apache.org">commits</a>"
           mail list.
        </p>
        <p>To update the website, visit <a href="https://cms.apache.org/incubator/publish">Publish site</a>
        and fill out the form.  Don't forget to give the CMS build system time to build your changes!
        The CMS provides a page for following the build process.
        </p>
    </section>
    <section id="other">
      <title id="other">Other notes</title>
      <p>Make sure that your subversion client is properly
        <a href="http://www.apache.org/dev/version-control.html#https-svn"
        >configured</a>.</p>
      <p>See other notes for maintenance of
        <a href="http://www.apache.org/dev/project-site.html"
        >apache.org project websites</a>.</p>
      <p>
        If you are still having trouble committing, then perhaps the Subversion
        authorization is not yet properly
        <a href="mentor.html#Set+Up+Repository">configured</a>
        to enable your group's access.
      </p>
    </section>
  </body>
</document>
